---
title: Usługa Azure komunikaty, ładunki i serializacja usługi Service Bus | Dokumentacja firmy Microsoft
description: Omówienie ładunków komunikatów usługi Service Bus
services: service-bus-messaging
documentationcenter: ''
author: axisc
manager: timlt
editor: spelluru
ms.service: service-bus-messaging
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/26/2018
ms.author: aschhab
ms.openlocfilehash: 3158f0255810c66605d28856133112181c2916db
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 06/13/2019
ms.locfileid: "61315643"
---
# <a name="messages-payloads-and-serialization"></a>Komunikaty, ładunki i serializacja

Microsoft Azure Service Bus obsługuje komunikaty. Komunikaty zawierają ładunek, a także metadane w postaci pary klucz wartość właściwości, opisujący ładunku i zapewniając instrukcje obsługi do magistrali usług i aplikacji. Od czasu do czasu tej samej metadanych jest wystarczająca do przenoszenia informacji, że nadawca chce, aby komunikować się do odbiorników i ładunku pozostaną puste.

Model obiektu oficjalne klienci usługi Service Bus dla platformy .NET i Java odzwierciedlają abstrakcyjny struktury komunikatów usługi Service Bus, która jest mapowana do i z usługi Service Bus obsługuje protokoły o komunikacji sieciowej.
 
Komunikat usługi Service Bus składa się z sekcją ładunek danych binarnych, obsługujący usługi Service Bus nigdy nie w dowolnej formie po stronie usługi, a dwa zestawy właściwości. *Brokera właściwości* są wstępnie zdefiniowane przez system. Te wstępnie zdefiniowane właściwości albo kontrolować funkcjonalność poziom komunikatu brokera lub mapują do elementów metadanych typowe i standardowy. *Właściwości użytkownika* to zbiór par klucz wartość, które mogą być definiowane i ustawiane przez aplikację.
 
Właściwości brokera wstępnie zdefiniowane są wymienione w poniższej tabeli. Nazwy są używane z wszystkie oficjalne interfejsów API klienta oraz w [BrokerProperties](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) obiekt JSON mapowanie protokołu HTTP.
 
Równoważne nazwy stosowane na poziomie protokołu AMQP podano w nawiasach. 

| Nazwa właściwości                         | Opis                                                                                                                                                                                                                                                                                                                                                                                                                               |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  [Typ zawartości](/dotnet/api/microsoft.azure.servicebus.message.contenttype) (typ zawartości)           | Opcjonalnie w tym artykule opisano ładunku komunikatu z deskryptorem następującego formatu RFC2045, sekcja 5; na przykład `application/json`.                                                                                                                                                                                                                                                                                             |
|  [Identyfikator korelacji](/dotnet/api/microsoft.azure.servicebus.message.correlationid#Microsoft_Azure_ServiceBus_Message_CorrelationId) (identyfikator korelacji)       | Umożliwia aplikacji określanie kontekstu dla wiadomości na potrzeby korelacji; na przykład odzwierciedlające **MessageId** komunikatu, który jest jest użytkownik.                                                                                                                                                                                                                                                                  |
| [DeadLetterSource](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deadlettersource)                      | Ustawić tylko w wiadomości, które zostały lettered wiadomości, a następnie automatycznie przesłany dalej z kolejki utraconych wiadomości do innej jednostki. Określa jednostki, w których był lettered Obsługa utraconych wiadomości. Ta właściwość jest tylko do odczytu.                                                                                                                                                                                                                                  |
| [DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount)                         | Liczba dostarczeń dokonanych dla tego komunikatu. Licznik jest zwiększany po wygaśnięciu blokady komunikat lub komunikat jest jednoznacznie przerwane przez odbiornik. Ta właściwość jest tylko do odczytu.                                                                                                                                                                                                                                                  |
| [EnqueuedSequenceNumber](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedsequencenumber)                | W przypadku wiadomości, które zostały przekazane automatycznie ta właściwość odzwierciedla numer sekwencji, który miał najpierw przypisany do wiadomości w punkcie, oryginalnym przesyłania. Ta właściwość jest tylko do odczytu.                                                                                                                                                                                                                                                                |
| [EnqueuedTimeUtc](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedtimeutc)                       | UTC błyskawiczne jaką komunikat został zaakceptowany i przechowywane w jednostce. Ta wartość może służyć jako wskaźnik przybycia autorytatywne i neutralne czasu, jeśli odbiorca nie ma być zaufania zegara nadawcy. Ta właściwość jest tylko do odczytu.                                                                                                                                                                                                   |
|  [ExpiresAtUtc](/dotnet/api/microsoft.azure.servicebus.message.expiresatutc) (ruch czas bezwzględna wygaśnięcia) | UTC błyskawiczne jaką wiadomość jest oznaczone do usunięcia i nie będą już dostępne do pobrania z jednostki z powodu jego wygaśnięcia. Wygaśnięcia jest kontrolowana przez **TimeToLive** właściwość i ta właściwość jest obliczany na podstawie EnqueuedTimeUtc + TimeToLive. Ta właściwość jest tylko do odczytu.                                                                                                                                                                           |
| [ForcePersistence](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.forcepersistence)                      | Dla kolejek lub tematów, które mają [EnableExpress](/dotnet/api/microsoft.servicebus.messaging.queuedescription.enableexpress) Flaga, można ustawić tej właściwości, aby wskazać komunikatu musi zostać utrwalone na dysku przed zostało potwierdzone. Jest to standardowe zachowanie dla wszystkich obiektów-express.                                                                                                                                                                                                         |
| [Etykieta](/dotnet/api/microsoft.azure.servicebus.message.label) (podmiot)                       | Ta właściwość umożliwia aplikacji wskazać przeznaczenie komunikatu do odbiorcy w sposób standardowy, podobnie jak wiersza tematu wiadomości e-mail.                                                                                                                                                                                                                                                                                  |
| [LockedUntilUtc](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.lockeduntilutc)                        | Komunikaty pobrane w ramach blokady (Odbierz komunikat trybu wstępnie nierozliczone) ta właściwość odzwierciedla, do której są przechowywane wiadomości błyskawicznych UTC zablokowane w kolejce/subskrypcji. Po wygaśnięciu blokady [DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount) jest zwiększany i komunikat jest ponownie dostępny do pobrania. Ta właściwość jest tylko do odczytu.                                                                                                                         |
| [LockToken](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.locktoken)                             | Token blokady jest odwołaniem do blokady, który jest zablokowany przez brokera w *Odbierz* tryb odbierania. Token może służyć do przypięcia blokady trwale za pomocą [odroczenia](message-deferral.md) interfejsu API i dzięki temu zająć komunikatów poza dostarczania regularnych przepływ stanu. Ta właściwość jest tylko do odczytu.                                                                                                                                                               |
| [Identyfikator komunikatu](/dotnet/api/microsoft.azure.servicebus.message.messageid) (identyfikator komunikatu)                | Identyfikator wiadomości jest wartością zdefiniowanych przez aplikację, który unikatowo identyfikuje wiadomość i ładunku. Identyfikator jest ciągiem i może odzwierciedlać identyfikatora GUID lub identyfikator pochodzących z kontekstu aplikacji. Jeśli włączona, [wykrywanie duplikatów](duplicate-detection.md) funkcji identyfikuje i usuwa drugi i dalszych zgłoszenia komunikaty z taką samą **MessageId**.                                                                |
| [PartitionKey](/dotnet/api/microsoft.azure.servicebus.message.partitionkey)                          | Aby uzyskać [partycjonowane jednostki do](service-bus-partitioning.md), ustawienie tej wartości umożliwia przypisywanie pokrewne wiadomości w tej samej partycji wewnętrzny, aby kolejność sekwencji przesyłania jest prawidłowo zarejestrowane. Partycja jest wybierany przez funkcję mieszania za pośrednictwem tej wartości i nie mogą być wybierane bezpośrednio. Dla jednostek obsługujących sesji **SessionId** właściwość zastępuje tę wartość.                                                                                                       |
| [ReplyTo](/dotnet/api/microsoft.azure.servicebus.message.replyto) (Odpowiedz do)                    | Ta wartość opcjonalne i zdefiniowanych przez aplikację jest standardowy sposób wyrażania ścieżką odpowiedzi do odbiorcy wiadomości. Gdy nadawca oczekuje odpowiedzi, ustawia wartość bezwzględną lub względną ścieżkę do kolejki lub oczekuje, że odpowiedź do wysłania do tematu.                                                                                                                                           |
| [ReplyToSessionId](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid) (reply-id grupy)  | Ta wartość rozszerzają **ReplyTo** informacji i określa, która **SessionId** powinna być ustawiona na odpowiedź, gdy wysyłane do jednostki odpowiedzi.                                                                                                                                                                                                                                                                            |
| [ScheduledEnqueueTimeUtc](/dotnet/api/microsoft.azure.servicebus.message.scheduledenqueuetimeutc)               | Komunikaty, które są udostępniane tylko do pobierania z opóźnieniem ta właściwość określa błyskawiczne UTC, o której wiadomość zostanie logicznie umieszczonych w kolejce, sekwencjonowania i w związku z tym dostępne do pobrania.                                                                                                                                                                                                                 |
| [sequenceNumber](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.sequencenumber)                        | Numer sekwencji jest unikatowy 64-bitową liczbę całkowitą przypisany do wiadomości, jak jest akceptowane i przechowywane przez brokera i funkcje jako jego wartość true, identyfikator. W przypadku partycjonowane jednostki znajdujące się najwyżej 16 bitów odzwierciedlają identyfikatora partycji. Numery sekwencyjne monotonicznie Zwiększ i są gapless. One przejdą do 0 po wyczerpaniu zakresu 48-x 64. Ta właściwość jest tylko do odczytu.                                                                |
| [Identyfikator sesji](/dotnet/api/microsoft.azure.servicebus.message.sessionid) (identyfikator grupy)                  | Dla jednostek obsługujących sesji tej wartości zdefiniowanych przez aplikację określa koligacji sesji wiadomości. Komunikaty z tego samego identyfikatora sesji podlegają podsumowania blokowania i Włącz dokładnie w określonej kolejności przetwarzania i demultipleksowanie. W przypadku jednostek, które nie są znane sesji ta wartość jest ignorowana.                                                                                                                                     |
| [Rozmiar](/dotnet/api/microsoft.azure.servicebus.message.size)                                  | Odzwierciedla przechowywanych rozmiar komunikatu w dzienniku broker na liczbę bajtów, ponieważ liczy się do limitu przydziału pamięci masowej. Ta właściwość jest tylko do odczytu.                                                                                                                                                                                                                                                                                                       |
| [State](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.state)                                 | Wskazuje stan komunikatu w dzienniku. Ta właściwość ma zastosowanie tylko podczas przeglądania ("Odbierz"), wiadomości do ustalenia, czy komunikat jest "aktywny" i dostępne do pobrania jako osiągnie wierzchołek kolejki, czy jest odroczone lub Trwa oczekiwanie na zaplanowane. Ta właściwość jest tylko do odczytu.                                                                                                                                           |
| [TimeToLive](/dotnet/api/microsoft.azure.servicebus.message.timetolive)                            | Ta wartość jest względna czasu trwania, po którym komunikat wygasa, począwszy od chwili komunikat został zaakceptowany i przechowywanych przez brokera, ponieważ przechwycone w **EnqueueTimeUtc**. Gdy nie są ustawione jawnie, jest zakładana wartość **DefaultTimeToLive** dla odpowiedniej kolejki lub tematu. Poziom komunikatu **TimeToLive** wartość nie może być dłuższa niż jednostki **DefaultTimeToLive** ustawienie. Jeśli jest on dłuższy, dyskretnie dopasowaniu. |
| [Aby](/dotnet/api/microsoft.azure.servicebus.message.to) (do)                               | Ta właściwość jest zarezerwowane dla przyszłego użytku w scenariuszach routingu i obecnie jest ignorowana przez sam brokera. Aplikacje mogą używać tej wartości w opartych na reguły automatycznego przekazywania dalej scenariusz tworzenia łańcucha, aby wskazać miejsce docelowe logiczne wiadomości.                                                                                                                                                                                   |
| [ViaPartitionKey](/dotnet/api/microsoft.azure.servicebus.message.viapartitionkey)                       | Jeśli komunikat jest wysyłany za pośrednictwem kolejki transferu w zakresie transakcji, ta wartość wybiera partycji kolejki transferu.                                                                                                                                                                                                                                                                                                                 |

Model abstrakcyjne komunikatów umożliwia komunikat wysyłany do kolejki za pośrednictwem protokołu HTTP (faktycznie zawsze HTTPS) i mogą być pobierane za pośrednictwem protokołu AMQP. W obu przypadkach komunikat wygląda normalne w ramach odpowiedniego protokołu. Właściwości brokera są przekształcane zgodnie z potrzebami, a właściwości użytkownika są mapowane na najbardziej odpowiedniej lokalizacji na podstawie modelu komunikatu protokołu odpowiednich. W protokole HTTP właściwości użytkownika mapować bezpośrednio do i z nagłówków HTTP; w AMQP mapują do i z **właściwości aplikacji** mapy.

## <a name="message-routing-and-correlation"></a>Routing komunikatów i korelacji

Podzbiór właściwości brokera opisanego wcześniej, w szczególności [do](/dotnet/api/microsoft.azure.servicebus.message.to), [ReplyTo](/dotnet/api/microsoft.azure.servicebus.message.replyto), [ReplyToSessionId](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid), [MessageId](/dotnet/api/microsoft.azure.servicebus.message.messageid), [ Identyfikator korelacji](/dotnet/api/microsoft.azure.servicebus.message.correlationid), i [SessionId](/dotnet/api/microsoft.azure.servicebus.message.sessionid), są używane aplikacje routing komunikatów do określonej lokalizacji docelowych. Aby zilustrować ten problem, należy wziąć pod uwagę kilka wzorców:

- **Proste żądanie/nietypizowana odpowiedź**: Wydawca wysyła komunikat do kolejki i oczekuje na odpowiedź od konsumenta komunikatów. Aby otrzymać odpowiedź, wydawcy jest właścicielem kolejki, do którego oczekuje odpowiedzi, które mają zostać dostarczone. Adres tej kolejki jest będzie wyrażana **ReplyTo** własności wiadomości wychodzących. Gdy użytkownik odpowie, kopiuje **MessageId** obsługiwanego wiadomości do **CorrelationId** właściwość komunikatu odpowiedzi i zapewnia komunikat, który ma miejsce docelowe wskazywanym przez **ReplyTo** właściwości. Jeden komunikat może przynieść wiele odpowiedzi, w zależności od kontekstu aplikacji.
- **Multiemisji żądanie/nietypizowana odpowiedź**: Odmiana wcześniejszego wzorca wydawca wysyła komunikat do tematu i wielu subskrybentów czerpać z komunikatu. Wszystkich subskrybentów może odpowiadać w sposób opisany wcześniej. Ten wzorzec jest używany w scenariuszach odnajdywania lub dokonują wywołań i jest strona przeciwna zwykle identyfikowany za pomocą właściwości użytkownika lub wewnątrz ładunku. Jeśli **ReplyTo** punktów do tematu, zestaw odpowiedzi odnajdywania mogą być dystrybuowane do odbiorców.
- **Funkcje multipleksowania**: Ta funkcja sesji umożliwia Multipleksowanie strumieni pokrewne wiadomości za pomocą jednej kolejki lub subskrypcji w taki sposób, że każdej sesji (lub grupy) pokrewne wiadomości, zidentyfikowane przez dopasowanie **SessionId** wartości, są kierowane do określonego odbiornika podczas odbiornika przechowuje sesji w ramach blokady. Dowiedz się więcej o szczegółowe informacje o sesjach [tutaj](message-sessions.md).
- **Żądanie/nietypizowana odpowiedź Multiplexed**: Ta funkcja sesji umożliwia zwielokrotnionym odpowiedzi, dzięki czemu kilku wydawców do udostępniania kolejki odpowiedzi. Ustawiając **ReplyToSessionId**, Wydawca może wydać consumer(s), aby skopiować tę wartość do **SessionId** właściwości komunikatu odpowiedzi. Publikowanie kolejki lub tematu nie trzeba pamiętać podczas sesji. Jak wiadomość jest wysyłana, Wydawca może specjalnie Zaczekaj, aż sesji z danego **SessionId** do zmaterializowania w kolejce, akceptując warunkowo odbiorcy sesji. 

Routing w przestrzeni nazw usługi Service Bus można realizować przy użyciu łańcucha automatycznego przekazywania dalej i reguły subskrypcji tematu. Routing w obszarach nazw można realizować [przy użyciu usługi Azure LogicApps](https://azure.microsoft.com/services/logic-apps/). Jak wskazano na poprzedniej liście **do** właściwość jest zarezerwowany do użytku w przyszłości i ostatecznie może być interpretowany przez brokera z funkcją specjalnie włączone. Aplikacje, które chcesz zaimplementować routing należy zrobić, więc na podstawie ich właściwości i nie Dowiedz się na **do** właściwości; jednak zrobić to teraz nie spowoduje problemów ze zgodnością.

## <a name="payload-serialization"></a>Ładunek serializacji

Podczas przesyłania lub przechowywane w usłudze Service Bus, ładunek jest zawsze blokiem nieprzejrzystych, binarny. [ContentType](/dotnet/api/microsoft.azure.servicebus.message.contenttype) właściwość umożliwia aplikacjom do opisania ładunek, za pomocą sugerowanego formatu dla wartości właściwości jest opis typ zawartości MIME, zgodnie z IETF RFC2045; na przykład `application/json;charset=utf-8`.

W odróżnieniu od warianty Java lub .NET Standard, .NET Framework w wersji interfejsu API usługi Service Bus obsługuje tworzenie **BrokeredMessage** wystąpienia przez przekazanie dowolnego obiektów platformy .NET do konstruktora. 

Gdy używasz starszej wersji protokołu SBMP, te obiekty są następnie serializowany z domyślnego elementu serializującego binarne lub zewnętrznie udostępniony element serializujący. Podczas korzystania z protokołu AMQP, serializowany jest obiekt na obiekt protokołu AMQP. Odbiorca może pobrać tych obiektów za pomocą [GetBody<T>()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.getbody#Microsoft_ServiceBus_Messaging_BrokeredMessage_GetBody__1) metodę podawania oczekiwanego typu. Z obsługą protokołu AMQP, obiekty są szeregowane w wykres AMQP **ArrayList** i **IDictionary < string, object >** ich dekodowania obiektów, a także dowolnego klienta protokołu AMQP. 

Ten magic ukryte serializacji jest wygodne, aplikacji należy wykonać jawną kontrolę odpowiedzialność za serializację obiektu Włącz ich wykresów obiektów do strumieni przed dołączeniem je do wiadomości i sytuacja odwrotna po stronie odbiorcy. To daje wyniki międzyoperacyjnych. Należy również zauważyć, gdy protokół AMQP charakteryzują się zaawansowanego modelu binarnego umożliwiający kodowania, jest powiązany z ekosystemem AMQP obsługi wiadomości i klientów HTTP będzie mieć problemy dekodowanie takich ładunków. 

Ogólnie zaleca się JSON i Apache Avro jako formaty ładunków danych strukturalnych.

Warianty .NET Standard i interfejsu API języka Java akceptować tylko tablice typu byte, co oznacza, że aplikacja musi obsłużyć sterowania serializacji obiektu. 

## <a name="next-steps"></a>Kolejne kroki

Aby dowiedzieć się więcej na temat obsługi komunikatów usługi Service Bus, zobacz następujące tematy:

* [Kolejki, tematy i subskrypcje usługi Service Bus](service-bus-queues-topics-subscriptions.md)
* [Wprowadzenie do kolejek usługi Service Bus](service-bus-dotnet-get-started-with-queues.md)
* [Jak używać tematów i subskrypcji usługi Service Bus](service-bus-dotnet-how-to-use-topics-subscriptions.md)
